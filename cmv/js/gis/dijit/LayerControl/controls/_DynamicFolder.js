/*  ConfigurableMapViewerCMV
 *  version 2.0.0-beta.1
 *  Project: http://cmv.io/
 */

define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/on","dojo/dom-class","dojo/dom-style","dojo/dom-attr","dojo/fx","dojo/html","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/Folder.html"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=a([j,k],{control:null,sublayerInfo:null,icons:null,templateString:l,_expandClickHandler:null,_handlers:[],postCreate:function(){if(this.inherited(arguments),this.control.controlOptions.subLayerInfos&&!this.control.controlOptions.includeUnspecifiedLayers){var a=c.map(this.control.controlOptions.subLayerInfos,function(a){return a.id});c.indexOf(a,this.sublayerInfo.id)<0&&e.add(this.domNode,"layerControlHidden")}this.control.controlOptions.layerIds&&c.indexOf(this.control.controlOptions.layerIds,this.sublayerInfo.id)<0&&e.add(this.domNode,"layerControlHidden");var f=this.checkNode;g.set(f,"data-sublayer-id",this.sublayerInfo.id),e.add(f,this.control.layer.id+"-layerControlSublayerCheck"),c.indexOf(this.control.layer.visibleLayers,this.sublayerInfo.id)!==-1?this._setSublayerCheckbox(!0,f):this._setSublayerCheckbox(!1,f),this._handlers.push(d(f,"click",b.hitch(this,function(){"checked"===g.get(f,"data-checked")?this._setSublayerCheckbox(!1,f):this._setSublayerCheckbox(!0,f),this.control._setVisibleLayers(),this._checkboxScaleRange()}))),i.set(this.labelNode,this.sublayerInfo.name),this._expandClick(),0===this.sublayerInfo.minScale&&0===this.sublayerInfo.maxScale||(this._checkboxScaleRange(),this._handlers.push(this.control.layer.getMap().on("zoom-end",b.hitch(this,"_checkboxScaleRange"))))},_expandClick:function(){var a=this.icons;this._handlers.push(this._expandClickHandler=d(this.expandClickNode,"click",b.hitch(this,function(){var b=this.expandNode,c=this.expandIconNode;"none"===f.get(b,"display")?(h.wipeIn({node:b,duration:300}).play(),e.replace(c,a.folderOpen,a.folder)):(h.wipeOut({node:b,duration:300}).play(),e.replace(c,a.folder,a.folderOpen))})))},_setSublayerCheckbox:function(a,b){b=b||this.checkNode;var c=this.icons;a?(g.set(b,"data-checked","checked"),e.replace(b,c.checked,c.unchecked)):(g.set(b,"data-checked","unchecked"),e.replace(b,c.unchecked,c.checked))},_checkboxScaleRange:function(){var a=this.checkNode,b=this.control.layer.getMap().getScale(),c=this.sublayerInfo.minScale,d=this.sublayerInfo.maxScale;e.remove(a,"layerControlCheckIconOutScale"),(0!==c&&b>c||0!==d&&b<d)&&e.add(a,"layerControlCheckIconOutScale")},destroy:function(){this.inherited(arguments),this._handlers.forEach(function(a){a.remove()})}});return m});
//# sourceMappingURL=_DynamicFolder.js.map